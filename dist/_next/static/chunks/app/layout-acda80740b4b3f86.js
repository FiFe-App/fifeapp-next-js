(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[185],{72431:function(){},47128:function(e,t,o){Promise.resolve().then(o.t.bind(o,52445,23)),Promise.resolve().then(o.bind(o,81828)),Promise.resolve().then(o.bind(o,92373)),Promise.resolve().then(o.bind(o,50603)),Promise.resolve().then(o.bind(o,24038)),Promise.resolve().then(o.bind(o,41010)),Promise.resolve().then(o.bind(o,97720)),Promise.resolve().then(o.bind(o,79802)),Promise.resolve().then(o.bind(o,50346)),Promise.resolve().then(o.bind(o,71342)),Promise.resolve().then(o.bind(o,15222)),Promise.resolve().then(o.bind(o,21830)),Promise.resolve().then(o.bind(o,65286)),Promise.resolve().then(o.bind(o,24734)),Promise.resolve().then(o.bind(o,74739)),Promise.resolve().then(o.bind(o,86647)),Promise.resolve().then(o.bind(o,34994)),Promise.resolve().then(o.bind(o,94940)),Promise.resolve().then(o.bind(o,415)),Promise.resolve().then(o.bind(o,97810)),Promise.resolve().then(o.bind(o,93199)),Promise.resolve().then(o.bind(o,28444)),Promise.resolve().then(o.bind(o,99329)),Promise.resolve().then(o.bind(o,36603)),Promise.resolve().then(o.bind(o,81441)),Promise.resolve().then(o.bind(o,19272)),Promise.resolve().then(o.bind(o,76144)),Promise.resolve().then(o.bind(o,17023)),Promise.resolve().then(o.bind(o,3194)),Promise.resolve().then(o.bind(o,32772)),Promise.resolve().then(o.bind(o,30594)),Promise.resolve().then(o.bind(o,63944)),Promise.resolve().then(o.bind(o,33097)),Promise.resolve().then(o.bind(o,38553)),Promise.resolve().then(o.t.bind(o,28674,23)),Promise.resolve().then(o.t.bind(o,63967,23))},81828:function(e,t,o){"use strict";o.r(t),o.d(t,{FirebaseContext:function(){return p},default:function(){return f}});var n=o(57437),s=o(92730),r=o(2265),a={apiKey:"AIzaSyDtxKGHmZsnpg2R7CKdkLl8oNSag9lHykI",authDomain:"fife-app.firebaseapp.com",databaseURL:"https://fife-app-default-rtdb.firebaseio.com",projectId:"fife-app",storageBucket:"fife-app.appspot.com",messagingSenderId:"235592798960",appId:"1:235592798960:web:39d151f49b45c29ef82835",measurementId:"G-10X8R8XT3L"},l=o(26142),i=o(81748),d=o(30828),u=o(42977),c=o(7908),g=o(76079),h=o(42392);let m=()=>{var e,t;let o=h.h.getState();return console.log("NODE_ENV","production"),{baseURL:"https://fifeapp.hu/.netlify/functions/index",headers:{authtoken:null==o?void 0:null===(t=o.user)||void 0===t?void 0:null===(e=t.userData)||void 0===e?void 0:e.authtoken}}};o(89507);var v=o(37134);let p=(0,r.createContext)(null);var f=e=>{let{children:t}=e,o=(0,d.I0)(),[h,f]=(0,r.useState)(null),b=(0,d.v9)(e=>e.user.uid),y=()=>{let e;try{e=(0,l.Mq)()}catch(t){e=(0,l.ZF)(a)}return e};(0,r.useEffect)(()=>{P()},[]);let P=async()=>(console.log("INIT"),(0,l.ZF)(a),w(),(0,s.Aj)((0,s.v0)(),async e=>{e?(console.log("FIREBASE user already loggen in"),console.log(e),e.reload().then(t=>{console.log("reload",t),o((0,u.x4)(e.uid))})):console.log("FIREBASE user not logged in")})),k=async()=>{let e=(0,g.KL)(),t=(0,i.N8)();console.log("msg init");try{if(!("Notification"in window))return;await Notification.requestPermission().then(n=>{console.log(n),"granted"!==n?o((0,u.rh)("notification")):(f(e),(0,g.LP)(e,{vapidKey:"BInTt__OonGUhBNBdQA57cu-VRHBm6N7vcsJBe_Q3o1Ei_2UgPSfM0ZzxyXsxohdrV_qooAywYzRilIv5OJ6VQE"}).then(e=>{e?(console.log(e),console.log(b),(0,i.t8)((0,i.iH)(t,"/users/"+b+"/data/fcm"),{token:e}).catch(e=>{console.log(e)}).then(e=>{console.log(e)})):console.log("No registration token available. Request permission to generate one.")}).catch(e=>{console.log("An error occurred while retrieving token. ",e)}))}).catch(e=>{console.error(e)})}catch(e){console.log("notification error",e)}},w=()=>{},z=async e=>{let t=(0,l.Mq)(),o=(0,s.v0)(t);return e&&""!=e?(0,s.LS)(o,e).then(e=>"K\xfcldt\xfcnk egy emailt, amivel vissza tudod \xe1ll\xedtani a fi\xf3kodat a rendes ker\xe9kv\xe1g\xe1sba!\n(N\xe9zd meg a spam mapp\xe1t is!)").catch(e=>(console.log(e),console.log(e.code),"auth/invalid-email"==e.code)?"Ez az email-c\xedm nem szerepel a rendszerben:(":"Aj-aj hiba t\xf6rt\xe9nt! Pr\xf3b\xe1ld meg k\xe9sőbb l\xe9gyszi"):"Email n\xe9lk\xfcl nem tudjuk vissza\xe1ll\xedtani a jelszavad"},S=async(e,t,n)=>{let r=null;return await (0,s.v0)().setPersistence(s.aT).then(async()=>{await (0,s.e5)((0,s.v0)((0,l.Mq)()),e,t).then(async e=>{let t=e.user;if(await t.getIdToken(!1).then(e=>{console.log(e),o((0,u.M)({authtoken:e,email:t.email,emailVerified:t.emailVerified,providerData:t.providerData,createdAt:t.metadata.creationTime,lastLoginAt:t.metadata.creationTime}))}),n){let e=(0,s.v0)((0,l.Mq)()).currentUser;if(console.log(e),null==e){console.log("USER NULL");return}console.log("set","users/".concat(e.uid,"/data"),n);try{await c.Z.post("users",n,m()).then(()=>{r={success:!0,user:e}}),await (0,i.t8)((0,i.iH)((0,i.N8)(),"users/".concat(e.uid,"/data/name")),n.name).then(()=>{console.log("RTDB updated")}),await (0,i.t8)((0,i.iH)((0,i.N8)(),"users/".concat(e.uid,"/settings/homeFilter")),n.interest).then(()=>{console.log("RTDB updated")})}catch(e){console.log("ERROR",e)}o((0,u.qC)(n.name))}else{let e=(0,i.iH)((0,i.N8)((0,l.Mq)()),"users/"+t.uid+"/settings");(0,i.U2)(e).then(e=>{e.exists()&&o((0,u.I2)(e.val()))});let n=(0,i.iH)((0,i.N8)((0,l.Mq)()),"users/"+t.uid+"/data/name");(0,i.U2)(n).then(e=>{e.exists()&&(o((0,u.qC)(e.val())),console.log(e.val()))})}v.default.push("/"),r={success:!0}}).catch(e=>{let t=e.code,o=e.message;console.error(e),r="auth/invalid-email"==t||"auth/user-not-found"==t?{error:"Bakfitty! Nem j\xf3 az email c\xedm, amit megadt\xe1l!"}:"auth/internal-error"==t?{error:"Az\xe1ld\xf3j\xe1t! A szerveren hiba t\xf6rt\xe9nt, pr\xf3b\xe1ld \xfajra!"}:"auth/wrong-password"==t?{error:"Azt a h\xe9t meg a nyolc\xe1t! Lehet el\xedrtad a jelszavad."}:"auth/too-many-requests"==t?{error:"\xd3 te j\xf3 \xe9g! T\xfal sokszor pr\xf3b\xe1lt\xe1l bejelentkezni, pr\xf3b\xe1lkozz k\xe9sőbb!"}:{error:"error: "+t+" - "+o}})}),r},N=async(e,t,o)=>{let n=null,r=(0,s.v0)();console.log("register",o),await (0,s.Xb)(r,e,t).then(async e=>{console.log("signed in as ",e.user.email)}).catch(e=>{let t=e.code,o=e.message;console.log(n="auth/invalid-email"==t?{error:"Nem j\xf3 az email, amit megadt\xe1l :("}:"auth/weak-password"==t?{error:"A jelszavad nem el\xe9g bonyi\nlegyen legal\xe1bb 6 karakter"}:"auth/wrong-password"==t?{error:"Rossz jelszavat adt\xe1l meg :/"}:{error:"error: "+t+" - "+o})});try{let n=await S(e,t,o);console.log("loginRes",n)}catch(e){console.log("set error",e)}return n},I=async()=>{let e=(0,s.v0)(),t=null;e.languageCode="hu",console.log("fb-login");let n=new s._O;return await (0,s.rh)(e,n).then(e=>{e.user,o((0,u.x4)(e.user.uid)),t={success:!0};let n=s._O.credentialFromResult(e);null==n||n.accessToken}).catch(o=>{let n=o.code,r=o.message;if(s._O.credentialFromError(o),t={error:"error: "+n+" - "+r},"auth/account-exists-with-different-credential"===n){o.credential;var a=o.email;(0,s.Nr)(e,a).then(function(o){if("password"===o[0]){(0,s.e5)(e,a,"password").then(function(e){}).then(function(){t={success:!0}});return}t={error:"facebook login error"}})}}),t};return(0,n.jsx)(p.Provider,{value:{app:y(),auth:(0,s.v0)(y()),database:(0,i.N8)(y()),api:{login:S,register:N,facebookLogin:I,logout:()=>{console.log("logout1"),(0,s.w7)((0,s.v0)());let e=(0,g.KL)();e&&(0,g.pQ)(e).then(e=>console.log("token deleted?",e)).catch(e=>console.error(e)).finally(()=>{o((0,u.kS)())})},forgotPassword:z},messaging:h,initMessaging:k},children:t})}},92373:function(e,t,o){"use strict";o.r(t),o.d(t,{default:function(){return a}});var n=o(57437),s=o(30828),r=o(42392);function a(e){let{children:t}=e;return(0,n.jsx)(s.zt,{store:r.h,children:t})}},42392:function(e,t,o){"use strict";o.d(t,{h:function(){return g}});var n=o(42977),s=o(17933),r=o(28166);let a=(0,r.oM)({name:"search",initialState:{history:[]},reducers:{push:(e,t)=>{let o=t.payload.toString();e.history.includes(o)&&e.history.splice(e.history.indexOf(o),1),e.history.push(o),e.history=e.history.slice(0,20)}}}),{push:l}=a.actions;var i=a.reducer;let d={key:"root",storage:o(76295).Z},u=(0,s.OJ)(d,n.ZP),c=(0,s.OJ)(d,i),g=(0,r.xC)({reducer:{user:u,search:c}});(0,s.p5)(g)},42977:function(e,t,o){"use strict";o.d(t,{I2:function(){return g},M:function(){return i},kS:function(){return a},qC:function(){return l},rh:function(){return c},x4:function(){return r}});let n=(0,o(28166).oM)({name:"user",initialState:{uid:null,name:null,userData:null,unreadMessage:[],settings:{randomTalk:!1,fancyText:!1,snowFall:!0,messages:{}},help:{messenger:!0},bugData:null,tempData:null},reducers:{init:async e=>{if(!e.uid){let t=await localStorage.getItem("uid");console.log("async loaded uid",t),t&&(e.uid=t)}},login:(e,t)=>{null==e.uid&&localStorage.setItem("loginAt",Date.now()),e.uid=t.payload,localStorage.setItem("uid",t.payload.toString()),console.log("logged in as",t.payload.toString())},logout:(e,t)=>(localStorage.setItem("uid",null),console.log("logged out",e),n.getInitialState()),setUserData:(e,t)=>{e.userData=t.payload},setSettings:(e,t)=>{e.settings=t.payload},emptyUnreadMessages:e=>{e.unreadMessage=[]},setUnreadMessage:(e,t)=>{e.unreadMessage.includes(t.payload)||e.unreadMessage.push(t.payload.toString())},removeUnreadMessage:(e,t)=>{let o=e.unreadMessage;(null==o?void 0:o.length)&&(e.unreadMessage=o.filter(function(e){return e!==t.payload}))},setName:(e,t)=>{e.name=t.payload},removeHelp:(e,t)=>{e.help[t.payload]=!1},setSettings:(e,t)=>{e.settings=t.payload},setBugData:(e,t)=>{e.bugData=t.payload},setTempData:(e,t)=>{e.tempData=t.payload},seenMessage:(e,t)=>{e.settings.messages?e.settings.messages[t.payload]||(e.settings.messages[t.payload]=!0):e.settings.messages={[t.payload]:!0}}}}),{init:s,login:r,logout:a,setName:l,setUserData:i,emptyUnreadMessages:d,setUnreadMessage:u,removeUnreadMessage:c,setSettings:g,removeHelp:h,setBugData:m,setTempData:v,seenMessage:p}=n.actions;t.ZP=n.reducer},52445:function(){}},function(e){e.O(0,[481,807,958,633,416,971,69,744],function(){return e(e.s=47128)}),_N_E=e.O()}]);